# SIP-0005: Fund Ephemeral Account RPC

## Description

Ephemeral accounts are a service offered by hosts that allow users to connect a
balance to a pubkey. Users can deposit funds into an ephemeral account with a
host and then later use the funds to transact with the host. The most common
transactions will be uploading and downloading data, however any RPC that
requires payment will support receiving payment from an ephemeral account.

To deposit funds into an ephemeral account, the host provides a fund ephemeral
account RPC. This RPC ties in with the forward payment RPC. By combining both
fund and forward RPC requests it will be possible to route payment to a host
with which you don't share an immediate payment link. This forms the basis for
payment routing.

## Motivation

Ephemeral accounts are motivated mainly by download latency. By allowing money
to be put into an ephemeral account, from which you can spend and pay for
subsequent RPC requests, we eliminate said latency.

## Fund Ephemeral Account Request

To fund an ephemeral account request the caller needs to specify which account
id to fund. Every detail related to the actual payment will be obfuscated by the
`extractPaymentFromRPC`. This means that an ephemeral account can be funded
through a file contract or another ephemeral account, all of which we do not
need to take into consideration in the fundEphemeralAccountRequest.

The fund ephemeral account response will contain a signature. This signature
will cover the account id that received funding, the amount which got funded
after subtracting the fee. This signature is a receipt, which the caller can use
to prove to others it successfully made payment to the host.

This receipt will prove necessary when fund ephemeral request is called in
combination with forward payment. To fund an ephemeral account on a host you do
not have an immediate payment link towards, you can call forward payment on a
host with which you do have a payment link that is connected to the host you are
trying to reach. By instructing to forward payment, that host will then call
fund ephemeral account on your behalf. To prove to you the account got funded,
he can provide you with the receipt.

```Go
type fundEphemeralAccountRequest {
    id string // ephemeral account id
}

type fundEphemeralAccountResponse {
    signature []byte // receipt
}

func (h *Host) managedRPCFundEphemeralAccount(conn net.Conn) error {
    // read fundEphemeralAccountRequest -> id
    // extractPaymentFromRPC -> amount
    // extract fee (based on RPC price table)
    // callDeposit(id, amount - fee)
    // write fundEphemeralAccountResponse
}
```