# SIP-0004: Update Host Price Table RPC

## Description

Add a host RPC to request a renewal of the host's RPC pricing table.

## Motivation

The host's RPC pricing table lists all available RPCs and its price. These
prices are calculated by the host and are only valid for a certain period of
time. When opening up a session with a host, it will store its most recent
prices on the shared session object.

When the TTL expires, the RPC pricing table must be updated before the host
fulfills any more RPC requests. To trigger an update, a custom RPC is required.

## Price Table

The price table is kept in JSON, the host will send a JSON encoded price table
over the wire upon request. It is JSON extended to allow for it to be
extendible when the host introduces a new RPC.

To allow the host to have dynamic pricing during the lifetime of a session, it
publishes its prices together with a TTL. The host will accept that price only
until that TTL expires. After it expires, the table must be renewed. This action
is triggered by the session counterparty, and is in itself a payable RPC.

## Update Price Table RPC

The price table is updated through an RPC call. This call is payable, seeing as
making it free would open up this RPC for a possible DoS attack vector.

The `updatePriceTableRequest` contains no data, details are explicit from
request and session.

The `updatePriceTableResponse` is JSON encoded and sent over the wire before any
payment is handled. This gives the caller the opportunity to quit the session if
it does not agree with prices. The host could have set an absurdly high base RPC
price, or UpdatePriceTable RPC price for instance.

```Go
func (h *Host) managedRPCUpdatePriceTable(conn net.Conn) error {
    // update price table request
    // update price table response (send JSON encoded price table)
    // extract payment from RPC
    // done
}
```
