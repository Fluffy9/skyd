# SIP-0004: Update Host Price Table RPC

## Description

When the renter and the host form a session, the host will build his pricing
table. This price table contains a list of RPCs the host offers alongside with
their price. This SIP will introduce a new RPC call on the host to request an
updated price table.

## Motivation

When the host communicates his price table, he will also set a block height at
which the prices expire and are no longer valid. Due to this TTL, the renter
will have to make sure that if he wants to transact with the host, he has
updated pricing information. This price table update has to be in the form of a
request to the host, seeing as the RPC to trigger the update is in and of itself
an RPC that requires payment. This is inevitable as otherwise the host would be
susceptible to DoS attacks.

Note that the renter will usually update this price table relatively frequent.
He does not want to wait just up until the expiry block height as the host will
not except any RPCs as long as the price table has not been updated. The renter
will not want to encounter the host denying all RPC requests mid-download
because of outdated pricing.

## RPC Price Table

The price table is a simple list of RPCs the host offers and the price it asks
for in return. When a session is formed, or when the renter requests a price
table update, the host will send it in JSON encoded format. This will allow for
it to be extendible when the host adds or removes an RPC call from the list.

The RPC calls and their pricing are highly dynamic and will change countless
times over the lifetime of a session. The TTL is introduced so the renter is
able to use this pricing information and build a routing table. If the pricing
would be different every minute, hour or block, it would have a hard time
building a routing table.

The price table requires to be updated after the TTL has expired. The host will
keep the price table on the session object, and if called he will see if the
pricing table is still valid. If it is not, it will reject any RPC other than
the `updatePriceTableRPC`.

It is the renter's responsibility to update the price table. He can do so by
using the `updatePriceTableRPC` call. Note that this RPC also requires payment.
This is inevitable as otherwise the host would be susceptible to DoS attacks.
The payment however is only extracted after the caller has received the price
table. This gives the caller the opportunity to quit the session, should one of
the host's prices be an exuberant amount of money for instance.

The RPCs are identified by a 48-byte specifier. It needs to be 48 bytes because
a possible example of an RPC could be the `forwardPaymentRPC`. Seeing as the
price of forwarding payment is dependant on the destination host, the RPC
identifier will need to include both the host id and rpc id, which in total
requires 48 bytes.
